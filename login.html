<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Pune Traffic Control System</title>
  <meta name="description" content="Government Traffic Monitoring System - Pune Division Login Portal">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/main.css">
</head>

<body>
  <div class="login-page">
    <div class="login-container">
      <div class="login-card">
        <div class="login-header">
          <div class="login-logo">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
            </svg>
          </div>
          <h1 class="login-title">Pune Traffic Control</h1>
          <p class="login-subtitle">Government Traffic Monitoring Portal - Maharashtra</p>
        </div>

        <form class="login-form" id="loginForm">
          <div class="form-group">
            <label class="form-label" for="govtId">Government ID</label>
            <input type="text" id="govtId" class="form-input" placeholder="Enter your Government ID"
              value="GOV-MH-2024-001" required>
          </div>

          <div class="form-group">
            <label class="form-label" for="mobile">Registered Mobile Number</label>
            <div class="input-with-prefix">
              <span class="input-prefix">+91</span>
              <input type="tel" id="mobile" class="form-input" placeholder="Enter 10-digit mobile" value="9876543210"
                maxlength="10" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="state">State</label>
              <select id="state" class="form-select" required disabled>
                <option value="maharashtra" selected>Maharashtra</option>
              </select>
              <span class="form-hint">Fixed to Maharashtra</span>
            </div>

            <div class="form-group">
              <label class="form-label" for="city">City</label>
              <select id="city" class="form-select" required>
                <option value="">Select City</option>
                <option value="pune" selected>Pune</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="password">Password</label>
            <input type="password" id="password" class="form-input" placeholder="Enter your password"
              value="password123" required>
          </div>

          <div class="login-options">
            <label class="form-checkbox">
              <input type="checkbox" checked>
              <span class="text-sm text-gray-600">Remember me</span>
            </label>
            <a href="forgot-password.html">Forgot password?</a>
          </div>

          <button type="submit" class="btn btn-primary login-btn">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="20"
              height="20">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
            </svg>
            Sign In to Pune Dashboard
          </button>
        </form>

        <div class="login-footer">
          <p>Maharashtra State Road Development Corporation</p>
          <p style="margin-top: 8px; color: #9ca3af;">Â© 2024 Pune Traffic Control Division</p>
        </div>
      </div>
    </div>
  </div>

  <!-- City Validation Message -->
  <div class="toast-container" id="toastContainer"></div>

  <script src="js/indian-locations.js"></script>
  <script src="js/app.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const stateSelect = document.getElementById('state');
      const citySelect = document.getElementById('city');

      // Populate States
      stateSelect.innerHTML = '<option value="">Select State</option>';
      stateSelect.disabled = false;

      Object.keys(indianStatesAndCities).sort().forEach(state => {
        stateSelect.innerHTML += `<option value="${state}">${state}</option>`;
      });

      // State Change Logic
      stateSelect.addEventListener('change', function () {
        const selectedState = this.value;
        citySelect.innerHTML = '<option value="">Select City</option>';

        if (selectedState && indianStatesAndCities[selectedState]) {
          citySelect.disabled = false;
          indianStatesAndCities[selectedState].sort().forEach(city => {
            citySelect.innerHTML += `<option value="${city}">${city}</option>`;
          });
        } else {
          citySelect.disabled = true;
        }
      });

      document.getElementById('loginForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const city = citySelect.value;
        const state = stateSelect.value;

        if (!state || !city) {
          showNotification('Please select both State and City', 'error');
          return;
        }

        // Optional: Strict check for Pune if this is specifically the Pune portal
        // But user asked for general login. For now we allow any valid selection but persist it.

        showNotification('Validating credentials...', 'info');

        setTimeout(() => {
          // Store login session
          localStorage.setItem('isLoggedIn', 'true');
          localStorage.setItem('userCity', city);
          localStorage.setItem('userState', state);
          localStorage.setItem('userName', 'Traffic Officer');
          localStorage.setItem('govtId', document.getElementById('govtId').value);

          showNotification('Login successful! Redirecting to Dashboard...', 'success');

          setTimeout(() => {
            window.location.href = 'index.html';
          }, 1000);
        }, 800);
      });
    });
  </script>
</body>

</html>